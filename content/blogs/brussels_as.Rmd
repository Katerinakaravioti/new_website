---
categories:  
- ""    #the front matter should be like the one found in, e.g., blog2.md. It cannot be like the normal Rmd we used
- ""
date: "2021-09-30"
description: Property types in Brussels # the title that will show up once someone gets to this page
draft: false
image: brussels2.jpg # save picture in \static\img\blogs. Acceptable formats= jpg, jpeg, or png . Your iPhone pics wont work

keywords: ""
slug: brussels_as # slug is the shorthand URL address... no spaces plz
title: Property types in Brussels
---


```{r, setup, echo=FALSE}
knitr::opts_chunk$set(
  message = FALSE, 
  warning = FALSE, 
  tidy=FALSE,     # display code as typed
  size="small")   # slightly smaller font for code
options(digits = 3)

# default figure size
knitr::opts_chunk$set(
  fig.width=6.75, 
  fig.height=6.75,
  fig.align = "center"
)
```


```{r load_data, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}

# use cache=TRUE so you dont donwload the data everytime you knit

listings <- vroom("http://data.insideairbnb.com/belgium/bru/brussels/2021-09-24/data/listings.csv.gz") %>% 
       clean_names()

#the list of columns which we found redundant and excluded from the analysis:
redundant_columns <- c("id", "listing_url", "scrape_id", "last_scraped", "name", "description", "neighborhood_overview", "picture_url", "host_id", "host_url", "host_name", "host_since", "host_location", "host_about", "host_thumbnail_url", "host_picture_url", "host_verifications", "neighborhood_group_cleansed", "bathrooms", "minimum_minimum_nights", "minimum_maximum_nights", "maximum_maximum_nights", "maximum_minimum_nights", "minimum_nights_avg_ntm", "maximum_nights_avg_ntm", "calendar_updated", "calendar_last_scraped", "license", "host_neighbourhood" , "neighbourhood", "neighbourhood_group_cleansed", "host_response_time", "host_response_rate", "host_acceptance_rate", "host_total_listings_count")
```



```{r}
listings <- listings %>%
  mutate(prop_type_simplified = case_when(
    property_type %in% c("Entire rental unit","Private room in rental unit", "Entire condominium (condo)","Private room in residential home") ~ property_type, 
    TRUE ~ "Other"
  ))
  
```

```{r}

listings %>% group_by(minimum_nights) %>% summarize(values = count(minimum_nights)) %>% arrange(desc(values))
```


```{r}
listings <- listings %>% filter(minimum_nights <= 4)

 

```
        
Visualization with a heatmap (i.e. color is differentiated depending on the price of accomodation)

```{r, out.width = '80%'}

#Create a heatmap of the prices:
listings$price_cuts <- cut(listings$price, 
                        quantile(listings$price), include.lowest = T,
                        labels = c('<50%', '50-100%', '100-150%', '150-200%'))
heatmap_colors <- colorFactor(palette = 'RdYlGn', listings$price_cuts)

leaflet(data = filter(listings, minimum_nights <= 4)) %>% 
  addProviderTiles("OpenStreetMap.Mapnik") %>% 
  addCircleMarkers(lng = ~longitude, 
                   lat = ~latitude, 
                   radius = 1, 
                   color = ~heatmap_colors(listings$price_cuts), 
                   fillOpacity = 0.3, 
                   popup = ~listing_url,
                   label = ~prop_type_simplified)
#delete the redundant column:
listings$price_cuts <- NULL

```
