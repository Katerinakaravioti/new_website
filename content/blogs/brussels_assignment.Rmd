---
categories:  
- ""    #the front matter should be like the one found in, e.g., blog2.md. It cannot be like the normal Rmd we used
- ""
date: "2021-09-30"
description: Property types in Brussels # the title that will show up once someone gets to this page
draft: false
image: brussels2.jpg # save picture in \static\img\blogs. Acceptable formats= jpg, jpeg, or png . Your iPhone pics wont work

keywords: ""
slug: brussels_assign # slug is the shorthand URL address... no spaces plz
title: Property types in Brussels
---
  



```{r, setup, echo=FALSE}
knitr::opts_chunk$set(
  message = FALSE, 
  warning = FALSE, 
  tidy=FALSE,     # display code as typed
  size="small")   # slightly smaller font for code
options(digits = 3)

# default figure size
knitr::opts_chunk$set(
  fig.width=6.75, 
  fig.height=6.75,
  fig.align = "center"
)
```


```{r load-libraries, echo=FALSE}
rm(list = ls())
library(tidyverse) # the usual stuff: dplyr, readr, and other goodies
library(lubridate) # to handle dates
library(GGally) # for correlation-scatter plot matrix
library(ggfortify) # to produce residual diagnostic plots
library(rsample) # to split dataframe in training- & testing sets
library(janitor) # clean_names()
library(broom) # use broom:augment() to get tidy table with regression output, residuals, etc
library(huxtable) # to get summary table of all models produced
library(kableExtra) # for formatting tables
library(moderndive) # for getting regression tables
library(skimr) # for skim
library(mosaic)
library(leaflet) # for interactive HTML maps
library(tidytext)
library(viridis)
library(leaps)
library(vroom)
```


```{r load_data, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}

# use cache=TRUE so you dont donwload the data everytime you knit

listings <- vroom("http://data.insideairbnb.com/belgium/bru/brussels/2021-09-24/data/listings.csv.gz") %>% 
       clean_names()
```


```{r}
listings$price <- readr::parse_number(listings$price)

```

```{r}
typeof(listings$price)

listings %>% group_by(property_type) %>% summarise(counts = count(property_type)) %>% arrange(desc(counts))
```

```{r, out.width = '80%'}

#Create a heatmap of the prices:
listings$price_cuts <- cut(listings$price, 
                        quantile(listings$price), include.lowest = T,
                        labels = c('<50%', '50-100%', '100-150%', '150-200%'))
heatmap_colors <- colorFactor(palette = 'RdYlGn', listings$price_cuts)

leaflet(data = filter(listings, minimum_nights <= 4)) %>% 
  addProviderTiles("OpenStreetMap.Mapnik") %>% 
  addCircleMarkers(lng = ~longitude, 
                   lat = ~latitude, 
                   radius = 1, 
                   color = ~heatmap_colors(listings$price_cuts), 
                   fillOpacity = 0.3, 
                   popup = ~listing_url,
                   label = ~prop_type_simplified)
#delete the redundant column:
listings$price_cuts <- NULL


#Note - we need to add legend to this :)
```
